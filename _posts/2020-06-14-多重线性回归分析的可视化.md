---
layout: post
title:   森林图在元分析和多元回归分析中的应用
date:   2020-06-14 22:10:20
categories: Statistics-Writing
---

# 森林图定义

森林图（forest plot）是用以展示多个研究或多个自变量对结果解释度的图形。一般为在平面直角坐标系中，以一条垂直于X轴的无效线（通常坐标X=1或0）为中心，用若干条平行于X轴的线段来表示每个研究或自变量的效应量大小及其95%可信区间，最后用一个棱形来表示多个研究合并的效应量及可信区间。


# 森林图类型

通常森林图有两种类型，一类是二分类变量森林图，一类是连续变量森林图。


## 二分类变量森林图

* 二分类变量研究中，常用相对危险度（relative rank, RR）、比值比（OR）或风险比（HR）来作为表示研究因素效应量大小的指标。
* 通常情况下，在森林图中以效应量点估计值=1作为无效线，假定无效线左侧为因素A（作为参照），无效线右侧为因素B。
* 当每个研究的效应量的95%CI包含1时，即森林图中的横线线段与无效线相交时，提示两组之间结局事件发生率的差异无统计学显著性，不能认为因素A、B对结局事件发生风险的影响存在差异。
* 例如无效线左侧表示A（安慰剂药物），右侧表示B（新款药物）。如果某研究的效应包括了比值1，则表明A和B没啥统计差异，即B药物的效果跟安慰剂效应没啥差别。

## 连续变量森林图

* 当研究的分析指标为连续变量时，此时可绘制连续变量森林图，在这类研究中，通常用加权均数差（Weighted Mean Difference，WMD）或者标准化均数差（Standardised Mean Difference，SMD）作为合并的统计量。


* 加权均数差（WMD），在Meta分析中，它主要用于具有相同连续性结局变量和相同测量单位的研究中。计算WMD时，每个原始研究的WMD为两组均数的差值，即试验组的均数减去对照组的均数。WMD以各个研究中原始的测量单位，真实地反映了研究效果，消除了绝对值大小对结果的影响。一般的，当不同研究的测量方法和测量单位相同时，宜选用WMD作为效应量，在实际的应用中更容易理解。

* 标准化均数差（SMD），由两组均数差值除以平均标准差计算而得，当不同研究的测量方法和测量单位不同，或者不同研究间均数的差异过大时，宜选用SMD作为效应量。SMD不仅消除了绝对值大小的影响，还消除了测量单位对结果的影响，是一个相对指标，结果的一致性优于WMD。但是在某些情况下，相对指标并不能反映结局事件的真实情况，容易夸大效应，结果的可解释性要弱于WMD，因此对于结果的解释要慎重。

* 当效应量=0时提示两组均数相等，因此通常在森林图中以效应量点估计值=0作为无效线，我们依然假定无效线左侧为因素A（作为参照），无效线右侧为因素B。

* 当效应量的95% CI包含0时，即森林图中的横线线段与无效线相交时，可认为两组之间的均数差异无统计学显著性，不能认为两组结局指标的均数不相等。

* 当效应量的95% CI均大于0时，即森林图中的横线线段与无效线不相交，且在无效线右侧，可认为因素B组结局指标的均数大于因素A组。一般情况下，若结局指标是不利事件时，则提示与因素A相比，因素B可引起结局指标的升高，为危险因素。

* 反之，当效应量的95% CI均小于0时，即森林图中的横线线段与无效线不相交，且在无效线左侧，可认为因素B组结局指标的均数小于因素A组。一般情况下，若结局指标是不利事件时，则提示与因素A相比，因素B可引起结局指标的降低，为保护因素。

# 森林图应用

## 元分析


## 多元回归分析

## 亚组分析

将亚组分析的结果用森林图来表示最为常见，此类森林图和上面我们介绍的森林图的意义相似，主要是根据我们分组的一些因素，例如年龄、性别等，把研究分成了不同的亚组，然后在不同亚组下分别进行分析和探讨。这样不仅可以展现各个亚组内试验因素的效应量大小，同时还可以直观的在亚组之间进行比较。

# 森林图绘制

1. [R语言代码实现-荷兰统计联盟](https://mp.weixin.qq.com/s/IebkZT5i3MNVrKDvID3xlQ)

# 参考资料
1. 主要参考自 “医咖会”微信公众号 https://www.sohu.com/a/225438746_489312


