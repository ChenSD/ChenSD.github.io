---
layout: post
title:   GroupICA
date:   2019-07-18 22:10:20
tags: [toolbox]
---

# ICA大概步骤

1. 将任务1数据视为静息态数据，使用GIFT工具包进行ICA分析；
2. 将ICA分析出的每一个脑网络当作一个ROI，制作ROI的mask；
然后用Marsbar提取mask内的每个被试每个ICA成分的时间序列；
3. Goodness-of-Fit
4. 计算步骤1和步骤2中每个对应成分的相关系数，将相关系数按照从高到低排列，
保留相关系数最高的前十个成分。这十个成分即是每个被试的十个预测指标。
5. 针对每个成分，组间比较。组间差异显著的成分保留为预测变量。


# ICA原理

[参考自网络教程](http://learning-archive.org/?p=110)

## Group ICA VS. Single-subject ICA 

单被试 ICA 和多被试 ICA（也叫做组水平 ICA）

## GroupICA算法之Informax

1. Gift默认设置使用的ICA 算法是Informax，选择“Informax”表示使用的 ICA 组分析算法是 TCGICA。
2. GroupICA分为两大步骤：
    * 第一步对所有被试的数据进行 ICA，获得一组组水平独立成分（生成文件*agg__component_ica_.nii）；
	* 第二步根据组水平独立成分重建每个被试的个体水平独立成分，
	每个被试生成一个文件，命名为*_sub*_component_ica_s1_.nii。

## GroupICA算法之GIG-ICA

如果要使用“GIG-ICA”，

1. 先在“Which Algorithm Do You Want To Use”选项中选择“GIGICA”，其他不变；	
2. 然后在弹出的下一个界面中选择一组组水平独立成分，这组组水平独立成分可以是 TCGICA 生成
的结果（*agg__component_ica_.nii），也可以是其他来源的独立成分模板

# 实际操作Gift

## Group ICA

[可以参考网络教程](http://learning-archive.org/?p=110)

1. 安装。Gift软件和其他包含ICA步骤的软件包有冲突（如EEGLAB），运行时需要先把其他软件包
从Matlab路径中移除
2. 数据准备。数据格式：root folder/subject folders。例如ICA_folder/sub_01/run1.nii。
因为每个被试的数据存放在每个被试文件夹下而不是被试文件夹的子文件夹，在GIFT设置数据时，
Are session folders inside subject folders?选择 No，选Yes会因为无法识别被试而报错。
3. 按照manual运行gift。
4. 运行结束后，all the components are stored in subject specific nifti files 
(*_sub*_component_ica_s1_.nii).
5. 运行结束后，默认会打开一个图像查看器，提供了四种看图方式.

## Statistical analysis

Gift提供了一些简单的统计功能，可以对某个成分进行单样本或双样本t-test。
这些统计功能基于SPM。

1. Gift/Utilities/SPM Stats/Select design as ”Two sample ttest”
2. Select a valid parameter file （参数问卷）/Select Component/Select data sets for group
3. 

## Time Courses

Look for time course images (*timecourse*.nii) and use icatb_loadData(file_name) to
get timecourse of all components.

1. [tc = icatb_loadData(timecourse_file_name) ](https://sourceforge.net/p/icatb/mailman/message/21519374/)


# References
1. http://learning-archive.org/?p=110